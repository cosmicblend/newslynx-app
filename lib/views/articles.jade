extends layout

block drawer
	ul.division-switcher
		li(data-mode="compare") Compare
		li(data-mode="detail") Detail view
	#drawer-pointers-container
	ul#article-list.drawer-list-item-ul

block templates
	script(type="text/jst")#tag-templ
		.tag-container
			.tag-name <%= name %>
			.tag-count <%= articles %>

	script(type="text/jst")#drawer-pointers-templ
		.drawer-pointer
			.drawer-item
				.add-to-comparison(data-action="replace")
					span.octicon-sync.octicon  
					span  Replace comparison with selection
			.drawer-item 
				.add-to-comparison(data-action="add")
					span.octicon-plus.octicon  
					span  Add selection to comparision


	script(type="text/jst")#article-summary-drawer-templ
		.drawer-list-outer
			.inputs-container
				input(type="checkbox")
			.drawer-list-inner
				.pub-date <%= date(timestamp) %>
				.title <%= title %>
				ul.tag-list#subject-tags
					<% _.each(subject_tags_full, function(tag){ %>
					li.subject-tag
						|<div class="color-swatch" style="background-color:<%= tag.color %>"></div>
						.info <%= tag.name %>
					<% }) %>
				ul.tag-list#impact-tags
					<% _.each(impact_tags_full, function(tag){ %>
					li.impact-tag
						|<div class="color-swatch" style="background-color:<%= tag.color %>"></div>
						.info <%= tag.name %>, <%= tag.category %>,  <%= tag.level %>
					<% }) %>

	script(type="text/jst")#article-detail-templ
		.article-detail-container
			.pub-date <%= date(timestamp) %>
			h2.headline <%= title %>
			.tag-container
				.tag-title Tags:
				ul.tags
					<% _.each(subject_tags_full, function(subject_tag){ %>
					|<li class="tag" style="background-color:<%= subject_tag.color %>;"><%= subject_tag.name %></li>
					<% }) %>
				.edit-tags
					button Edit
			.toolbar
				.group-container(data-side="left")
					.group-item
						.group-title Tell me about:
						ul.tabs
							li.tab.active This story's life
							li.tab Who's reading and sharing it
				.group-container(data-side="right")
					.group-item
						button.create-event + Create event
					.group-item
						span.icon-comparison vs
						select#article-comparer
							option an average article
							option another thing
			section(data-name="timeline")
				h3.title How many people saw it and when was it shared on social media?
				#ST-chart
			section(data-name="social-posts")
				h3.title Who is posting this story to social media?
				img(src="images/dummy/social-posts.png")
			section(data-name="traffic-sources")
				h3.title Where is traffic coming from?
				.description
					p This article generally has above-average traffic both from internal and external referalls. As a percentage, external traffic is larger by 10%, which is pretty normal.
				img(src="images/dummy/traffic-sources.png")
			section(data-name="citations")
				h3.title Who is citing this story
				img(src="images/dummy/citations.png")
			section(data-name="events")
				h3.title What events have happened around this story?
				img(src="images/dummy/events.png")

	script(type="text/jst")#article-grid-container-templ
		#compare-grid
			.header
				.header-meta-container
					.header-meta.cell
						.name Social shares
					.header-meta.cell
						.name Visitors
					.header-meta.cell
						.name Sources
					.header-meta.cell.bars
						.name Tags
				.header-dimensions-container
					.header-el.cell.wide(data-metric="title")
						.name Headline
					.header-el.cell.date(data-metric="timestamp").active
						.name Date
					.header-el.cell.multi(data-metric="twitter")
						.name Twitter
					.header-el.cell.multi(data-metric="facebook")
						.name Facebook
					.header-el.cell.multi(data-metric="pageviews")
						.name Pageviews
					.header-el.cell.multi(data-metric="time-on-page")
						.name Time/page
					.header-el.cell.multi(data-metric="internal")
						.name Internal
					.header-el.cell.multi(data-metric="external")
						.name External
					.header-el.cell.bars(data-metric="subject")
						.name Subject
					.header-el.cell.bars(data-metric="impact")
						.name Impact
			.rows

	//-  TODO, sort by % over comparison
	script(type="text/jst")#article-summary-row-templ
		.article-detail-row-container
			.destroy &times;

block css
	link(rel='stylesheet', href='/stylesheets/thirdparty/spotted-tail.css')

block bootstrap-data
	script(id="page-data").
		var pageData = {};
		pageData.impact_tag_categories 	=!{JSON.stringify(impact_tag_categories)};
		pageData.impact_tag_levels		 	=!{JSON.stringify(impact_tag_levels)};
		pageData.subject_tags 					=!{JSON.stringify(subject_tags)};
		pageData.impact_tags 						=!{JSON.stringify(impact_tags)};
		pageData.articleSummaries 			=!{JSON.stringify(articleSummaries)};
		pageData.articleDetails 				=!{JSON.stringify(articleDetails)};
		pageData.eventSchemas 					=!{JSON.stringify(eventSchemas)};
		pageData.orgInfo			 					=!{JSON.stringify(orgInfo)};

block scripts
	script(src="javascripts/thirdparty/jquery-1.11.0.min.js")
	script(src="javascripts/thirdparty/underscore-min.js")
	script(src="javascripts/thirdparty/backbone-min.js")
	script(src="javascripts/thirdparty/d3.v3.min.js")
	script(src="javascripts/thirdparty/isotope.pkgd.min.js")
	script(src="javascripts/thirdparty/jquery.easing.js")
	script(src="javascripts/thirdparty/spotted-tail.js")
	script(src="javascripts/thirdparty/pourover.js")
		
	//- Put it all together
	script(src="javascripts/main.bundled.js")

