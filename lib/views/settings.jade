extends layout

block drawer
	.division-title Settings
	.division-description
		p Here you can change your account settings to track new Twitter or Facebook accounts or alert your Google Authentication

block templates
	script(type="text/jst")#settings-templ
		#settings
			.settings-group
				#account.settings-title Account
				.setting-group
					#password.setting-title Change password
					ul.inputs-container(data-key="password")
						li.input.multi
							input.input-item(type="password" placeholder="New password...")
						li.input.multi
							input.input-item(type="password" placeholder="Confirm...")
				#site.settings-title Site
				.setting-group
					#home-page.setting-title Home page
					ul.inputs-container(data-key="homepage")
						li.input
							|<input class="input-item" type="text" placeholder="propalpatine.org" value="<%= homepage %>">
				.setting-group
					#home-page.setting-title Time zone
					ul.inputs-container(data-key="timezone")
						li.input
							//- |<input type="text" placeholder="propalpatine.org" value="<%= homepage %>">
							select(name='timezone').input-item
								|<option value='-5'  <% ((timezone == '-5') ? print('selected') : '')  %> > (GMT -5:00) Eastern Time</option>
								|<option value='-6'  <% ((timezone == '-6') ? print('selected') : '')  %> > (GMT -6:00) Central Time</option>
								|<option value='-7'  <% ((timezone == '-7') ? print('selected') : '')  %> > (GMT -7:00) Mountain Time</option>
								|<option value='-8'  <% ((timezone == '-8') ? print('selected') : '')  %> > (GMT -8:00) Pacific Time</option>
								|<option value='-9'  <% ((timezone == '-9') ? print('selected') : '')  %> > (GMT -9:00) Alaska</option>
								|<option value='-10' <% ((timezone == '-10') ? print('selected') : '') %> > (GMT -10:00) Hawaii</option>
				.setting-grou
					.setting-description Does your site publish an RSS feed of all its articles?
					.setting-flag Includes full article text?
					.setting-title URLs
					ul.inputs-container(data-placeholder="propalpatine.org" data-flag="checkbox" data-key="rss_feeds")
						<%  for (var i = 0; i < rss_feeds.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="propalpatine.org" value="<%= rss_feeds[i].url %>" class="multi-child" data-key="url" />
							|<input class="input-item" type="checkbox" <% ((rss_feeds[i].full_text === true) ? print('checked') : '') %> data-key="full_text"/>
						<% } %>
					button.add Add
			.settings-group
				#social.settings-title Social
				.setting-group
					.setting-description If you use a custom URL shortener, what do your links look like on twitter. Please omit a trailing slash.
					.setting-title Short URL
					ul.inputs-container(data-placeholder="propalp.tn" data-key="short_urls")
						<%  for (var i = 0; i < short_urls.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="propalp.tn" value="<%= short_urls[i] %>" class="multi-child" />
						<% } %>
					button.add Add
				.setting-group
					.setting-description If you want to track how your articles are shared among staff, create a Twitter list of their accounts and add the Twitter account name who owns the list and the list “slug.
					#staff-lists.setting-title Staff lists
					ul.inputs-container(data-layout="double" data-placeholder='["ProPalpatine","staff"]' data-key="twitter_staff_list")
						<%  for (var i = 0; i < twitter_staff_list.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="ProPalpatine" value="<%= twitter_staff_list[i].owner %>" class="multi-child double" data-key="owner"/>
							|<input class="input-item" type="text" placeholder="staff" value="<%= twitter_staff_list[i].slug %>" class="multi-child double" data-key="slug"/>
						<% } %>
					button.add Add
				.setting-group
					.setting-description What social accounts does your newsroom use? NewsLynx monitors them to know what’s being promoted.
					.setting-flag Is main account?
					#twitter-accounts.setting-title Twitter accounts
					ul.inputs-container(data-placeholder="ProPalpatine" data-flag="radio" data-group="twitter" data-key="twitter_accounts")
						<%  for (var i = 0; i < twitter_accounts.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="ProPalpatine" value="<%= twitter_accounts[i].handle %>" class="multi-child" data-key="handle" />
							|<input class="input-item" type="radio" name="twitter" <% ((twitter_accounts[i].is_main === true) ? print('checked') : '') %> data-key="is_main" />
						<% } %>
					button.add Add				
				.setting-group
					.setting-flag Is main account?
					#facebook-accounts.setting-title Facebook accounts
					ul.inputs-container(data-placeholder="ProPalpatine" data-flag="radio" data-group="facebook" data-key="facebook_accounts")
						<%  for (var i = 0; i < facebook_accounts.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="ProPalpatine" value="<%= twitter_accounts[i].handle %>" class="multi-child" data-key="handle" />
							|<input class="input-item" type="radio" name="facebook" <% ((facebook_accounts[i].is_main === true) ? print('checked') : '') %> data-key="is_main" />
						<% } %>
					button.add Add
			.settings-group
				#tags.settings-title Tags
				.setting-group
					#article-tags.setting-title Article tags
					ul.inputs-container(data-placeholder="Fracking" data-flag="color" data-group="articles" data-key="article_tags")
						<%  for (var i = 0; i < article_tags.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="Fracking" value="<%= article_tags[i].name %>" class="multi-child" data-key="name" />
							|<input class="input-item color-picker" type="text" data-color="<%= article_tags[i].color %>" value="<%= article_tags[i].color %>" data-group="articles" data-key="color" />
						<% } %>
					button.add Add				
				.setting-group
					#impact-tags.setting-title Impact tags
					ul.inputs-container(data-placeholder="Legislative impact" data-flag="color" data-group="impact" data-key="impact_tags")
						<%  for (var i = 0; i < impact_tags.length; i++) { %>
						li.input.multi
							.multi-child.destroy &times;
							|<input class="input-item" type="text" placeholder="Legislative impact" value="<%= impact_tags[i].name %>" class="multi-child" data-key="name"/>
							|<input class="input-item color-picker" type="text" data-color="<%= impact_tags[i].color %>" value="<%= impact_tags[i].color %>" data-group="impact" data-key="color"/>
						<% } %>
					button.add Add	
			.settings-group
				#google-analytics.settings-title Google analytics
				.setting-description We use this data to show you things like pageviews and unique visitors over time. We will only use data for research purposes. 
					a(href="/about") Read our data retention policy for more information.
				.setting-group
					.setting-title Authenticated
					if req.user
						p.auth-result.success Yes
					else
						p.auth-result.fail No
						a(href='/auth/google').authenticate
							button Grant access
							//- form(action='/organizations/settings', method='POST')
							//- 	!= form
			.save-container
				input(type="submit" value="Save changes")#save


	//- script(type="text/jst")#settings-group-templ
	//- 	.settings-group
	//- 		.settings-title <%= settings_title %>

	//- script(type="text/jst")#setting-group-templ
	//- 	.setting-group
	//- 		<% (description) ? print('<div class="setting-description">'+description+'</div>' : '') %>
	//- 		<% (flag) ? print('<div class="setting-flag">'+flag+'</div>' : '') %>
	//- 		.setting-title <%= setting_title %>
	//- 		|<ul class="inputs-container" <% (multi === true) ? print('data-placeholder="'+placeholder+'"' : '') %> <% (flag === true) ? print('data-flag="'+flag+'"' : '') %> ></ul>

	//- script(type="text/jst")#single-input-templ
	//- 	ul.inputs-container
	//- 		li.input
	//- 			|<input type="text" placeholder="<%= placeholder %>" value="<% (val) ? print(val) : '' %>">

	script(type="text/jst")#multi-input-templ
		li.input.multi
			.multi-child.destroy &times;
			|<input class="multi-child input-item" type="text" placeholder="<%= placeholder %>" data-key="<%= keys[0] %>"/>
			<% if (flag == 'radio') { %>
			<% print('<input class="input-item" type="'+flag+'" name="'+group+'" data-key="'+keys[1]+'"/>') %>
			<% } else if (flag == 'checkbox') { %>
			<% print('<input class="input-item" type="'+flag+'" data-key="'+keys[1]+'"/>') %>
			<% } else if (flag == 'color') { %>
			<% print('<input class="color-picker input-item" type="text" data-color="#ccc" data-group="'+group+'" data-key="'+keys[1]+'"/>') %>
			<% } %>

	script(type="text/jst")#multi-input-double-templ
		li.input.multi
			.multi-child.destroy &times;
			|<input class="multi-child double input-item" type="text" placeholder="<%= placeholder0 %>" data-key="<%= keys[0] %>" />
			|<input class="multi-child double input-item" type="text" placeholder="<%= placeholder1 %>" data-key="<%= keys[1] %>" />
			<% (flag) ? print('<input class="input-item" type="'+flag+'" data-key="'+keys[2]+'" />') : '' %>

block bootstrap-data
	script(id="page-data").
		var pageData = {};
		pageData.org =!{JSON.stringify(org)};
		//- pageData.settingsSchema =!{settingsSchema};

block css
	link(rel='stylesheet', href='/stylesheets/thirdparty/spectrum.css')

block scripts
	script(src="javascripts/thirdparty/jquery-1.11.0.min.js")
	script(src="javascripts/thirdparty/underscore-min.js")
	script(src="javascripts/thirdparty/backbone-min.js")
	script(src="javascripts/thirdparty/spectrum.js")
	script(src="javascripts/main.js")